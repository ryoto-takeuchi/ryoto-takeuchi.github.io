---
title: Rabi frequency
layout: default
---

<h1>Rabi frequency</h1>
<p class="muted">Formula: Ω = Γ √( I / (2 I_sat) ). Enter Γ/2π in MHz, I and I_sat in mW/cm². You can also choose atom/transition presets.</p>

<div class="card">
  <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:end">
    <label>Atom<br><select id="atomSel"></select></label>
    <label>Transition<br><select id="tranSel"></select></label>
    <button id="applyPreset">Apply preset</button>
  </div>
  <hr>
  <label>Γ/2π [MHz] <input id="g" type="number" step="0.000001" value="32"></label>
  <label>I [mW/cm²] <input id="I" type="number" step="0.0001" value="5"></label>
  <label>I_sat [mW/cm²] <input id="Is" type="number" step="0.000001" value="40.5"></label>
  <button id="run">Compute</button>
  <pre id="out" class="muted">Loading Python (Pyodide)…</pre>
</div>

<script type="module">
  import { loadPyodide } from "https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.mjs";

  const state = { data: null };

  function populateSelectors(){
    const atomSel = document.getElementById('atomSel');
    const tranSel = document.getElementById('tranSel');
    atomSel.innerHTML = "";
    state.data.atoms.forEach((a, idx)=>{
      const opt = document.createElement('option');
      opt.value = idx;
      opt.textContent = a.species;
      atomSel.appendChild(opt);
    });
    updateTransitionOptions();
    atomSel.onchange = updateTransitionOptions;
    function updateTransitionOptions(){
      const atom = state.data.atoms[parseInt(atomSel.value||0,10)] || state.data.atoms[0];
      tranSel.innerHTML = "";
      atom.transitions.forEach((t, j)=>{
        const opt = document.createElement('option');
        opt.value = j;
        opt.textContent = t.label;
        tranSel.appendChild(opt);
      });
    }
  }

  function wireApplyPreset(){
    document.getElementById('applyPreset').onclick = ()=>{
      const atomIdx = parseInt(document.getElementById('atomSel').value||0,10);
      const tranIdx = parseInt(document.getElementById('tranSel').value||0,10);
      const atom = state.data.atoms[atomIdx];
      const t = atom.transitions[tranIdx];
      if(!t) return;
      document.getElementById('g').value = t.gamma_2pi_MHz;
      document.getElementById('Is').value = t.Isat_mWcm2;
    };
  }

  try {
    const resp = await fetch("/tools/transitions.json", {cache:"no-store"});
    state.data = await resp.json();
    populateSelectors();
    wireApplyPreset();
  } catch (e) {
    console.error("Preset load error:", e);
  }

  try {
    const pyodide = await loadPyodide();
    window.__pyodide__ = pyodide;
    const res = await fetch("/tools/common.py", {cache:"no-store"});
    const txt = await res.text();
    await pyodide.runPythonAsync(txt);
    document.getElementById('out').textContent = "Ready.";
  } catch (e) {
    document.getElementById('out').textContent = "Pyodide load error: " + e.message;
    console.error(e);
  }
</script>

<script>
  async function compute(){
    const out = document.getElementById('out');
    try{
      const pyodide = window.__pyodide__;
      if(!pyodide){ out.textContent = "Pyodide is not ready."; return; }
      const g  = parseFloat(document.getElementById('g').value);
      const I  = parseFloat(document.getElementById('I').value);
      const Is = parseFloat(document.getElementById('Is').value);
      const code = `
from math import pi
Omega = omega_from_gsat(${g}, ${I}, ${Is})
Omega_2pi = Omega/(2*pi)
result = "Omega = {:.6e} rad/s\\nOmega/2pi = {:.6f} Hz".format(Omega, Omega_2pi)
`;
      await pyodide.runPythonAsync(code);
      out.textContent = pyodide.globals.get('result');
    }catch(e){
      out.textContent = "Runtime error: " + e.message;
      console.error(e);
    }
  }
  document.addEventListener('click', (e)=>{
    if(e.target && e.target.id === 'run'){ compute(); }
  });
</script>
